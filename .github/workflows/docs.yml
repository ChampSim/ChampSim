name: Update Documentation

on:
  push:
    branches:
      - master
      - develop
      - feature/*
      - release/*
    paths:
      - 'doc/**'

permissions:
  contents: write

jobs:
  publish-wiki:
    runs-on: ubuntu-latest

    steps:
      - name: Set Up Environment
        run: python3 -m pip install sphinx sphinx-rtd-theme sphinx-multiversion

      - uses: actions/checkout@v4

      - name: Build Documentation
        run: sphinx-multiversion docs _build

      - uses: actions/checkout@v4
        with:
          ref: gh-pages

      - name: Install HTML sources
        run: mv _build/${{ github.event.base_ref }} .

      - uses: EndBug/add-and-commit@v9
        with:
          default_author: github_actions
          message: |
            Update documentation for branch ${{ github.event.base_ref }}.

            Author: ${{ github.event.head_commit.author }}
            Committer: ${{ github.event.head_commit.committer }}

            ${{ github.event.head_commit.message }}


